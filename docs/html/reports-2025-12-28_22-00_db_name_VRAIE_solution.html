<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="X-Filamenta Documentation - üîß SOLUTION D√âFINITIVE ‚Äî Nom de BD (le vrai probl√®me)">
    <title>üîß SOLUTION D√âFINITIVE ‚Äî Nom de BD (le vrai probl√®me) - X-Filamenta Documentation</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>üìö X-Filamenta Documentation</h1>
        <nav>
            <a href="index.html">Home</a>
            <a href="all-pages.html">All Pages</a>
            <a href="analysis-reports.html">Analysis Reports</a>
        </nav>
    </header>

    <div class="container">
        <aside class="sidebar">
            <div class="sidebar-section">
  <div class="sidebar-title">Getting Started</div>
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="00_START_HERE.html">Start Here</a></li>
    <li><a href="guides-QUICKSTART.html">Quick Start</a></li>
    <li><a href="REFERENCE.html">Reference</a></li>
  </ul>
</div>
<div class="sidebar-section">
  <div class="sidebar-title">Features</div>
  <ul>
    <li><a href="features-README.html">Overview</a></li>
    <li><a href="features-authentication.html">Authentication</a></li>
    <li><a href="features-wizard-installation.html">Installation Wizard</a></li>
    <li><a href="features-internationalization.html">Internationalization</a></li>
    <li><a href="features-database.html">Database Support</a></li>
  </ul>
</div>
<div class="sidebar-section">
  <div class="sidebar-title">Deployment</div>
  <ul>
    <li><a href="deployment-DEPLOYMENT.html">Overview</a></li>
    <li><a href="deployment-DEPLOYMENT_CPANEL.html">cPanel</a></li>
    <li><a href="deployment-DEPLOYMENT_VPS.html">VPS/Linux</a></li>
    <li><a href="deployment-DEPLOYMENT_DOCKER.html">Docker</a></li>
  </ul>
</div>
<div class="sidebar-section">
  <div class="sidebar-title">Architecture</div>
  <ul>
    <li><a href="architecture-README.html">Overview</a></li>
    <li><a href="DATABASE.html">Database</a></li>
    <li><a href="technical-WSGI_AND_MULTIDB_ADAPTATION.html">WSGI & Multi-DB</a></li>
  </ul>
</div>
<div class="sidebar-section">
  <div class="sidebar-title">Security</div>
  <ul>
    <li><a href="security-README.html">Overview</a></li>
  </ul>
</div>
<div class="sidebar-section">
  <div class="sidebar-title">Contributing</div>
  <ul>
    <li><a href="contributing-README.html">Guidelines</a></li>
  </ul>
</div>
<div class="sidebar-section">
  <div class="sidebar-title">Help</div>
  <ul>
    <li><a href="troubleshooting-README.html">Troubleshooting</a></li>
    <li><a href="troubleshooting-faq.html">FAQ</a></li>
    <li><a href="troubleshooting-common-issues.html">Common Issues</a></li>
    <li><a href="analysis-reports.html">Analysis Reports</a></li>
  </ul>
</div>

        </aside>

        <main class="main">
            <h1 id="solution-definitive-nom-de-bd-le-vrai-probleme">üîß SOLUTION D√âFINITIVE ‚Äî Nom de BD (le vrai probl√®me)</h1>
<p><strong>Date</strong> : 2025-12-28T22:00:00+01:00<br />
<strong>Statut</strong> : ‚úÖ Probl√®me identifi√© et corrig√©<br />
<strong>Action</strong> : <strong>RED√âMARRAGE DU SERVEUR REQUIS</strong></p>
<hr />
<h2 id="le-vrai-probleme">üéØ LE VRAI PROBL√àME</h2>
<h3 id="vous-disiez">Vous disiez :</h3>
<blockquote>
<p>"J'ai inscrit qwerty.db et affiche sqlite:///D:\xarema\X-Filamenta-Python\instance\app.db"</p>
</blockquote>
<h3 id="verifications-effectuees">V√©rifications effectu√©es :</h3>
<div class="highlight"><pre><span></span><code><span class="c"># .env contient BIEN le bon chemin :</span>
<span class="n">SQLALCHEMY_DATABASE_URI</span><span class="p">=</span><span class="n">sqlite</span><span class="p">:///</span><span class="n">D</span><span class="p">:/</span><span class="n">xarema</span><span class="p">/</span><span class="n">X-Filamenta-Python</span><span class="p">/</span><span class="n">instance</span><span class="p">/</span><span class="n">qwerty</span><span class="p">.</span><span class="n">db</span>

<span class="c"># Les BD cr√©√©es :</span>
<span class="n">qwerty</span><span class="p">.</span><span class="n">db</span>   <span class="n">57344</span> <span class="n">bytes</span>  <span class="err">‚úÖ</span> <span class="p">(</span><span class="n">bonne</span> <span class="n">BD</span><span class="p">,</span> <span class="n">avec</span> <span class="n">donn√©es</span><span class="p">)</span>
<span class="n">app</span><span class="p">.</span><span class="n">db</span>      <span class="n">0</span> <span class="n">bytes</span>       <span class="err">‚ùå</span> <span class="p">(</span><span class="n">vide</span><span class="p">,</span> <span class="n">cr√©√©e</span> <span class="n">au</span> <span class="n">d√©marrage</span><span class="p">)</span>
</code></pre></div>

<h3 id="le-probleme">Le probl√®me :</h3>
<p><strong>Le serveur utilise toujours <code>app.db</code> parce qu'il n'a PAS √©t√© red√©marr√© apr√®s l'installation !</strong></p>
<hr />
<h2 id="pourquoi-ca-na-pas-fonctionne">üîç Pourquoi √ßa n'a pas fonctionn√© ?</h2>
<h3 id="flux-actuel-avant-redemarrage">Flux actuel (AVANT red√©marrage)</h3>
<ol>
<li><strong>Serveur d√©marre</strong> ‚Üí <code>config.py</code> charge <code>.env</code> ‚Üí √Ä ce moment, <code>SQLALCHEMY_DATABASE_URI</code> n'existe pas encore</li>
<li><strong>Serveur utilise le d√©faut</strong> : <code>app.db</code></li>
<li><strong>Wizard s'ex√©cute</strong> ‚Üí Cr√©e <code>qwerty.db</code> + √©crit dans <code>.env</code></li>
<li><strong>Mais le serveur continue de tourner</strong> ‚Üí Il utilise toujours <code>app.db</code> en m√©moire</li>
<li><strong>Page verify-db</strong> ‚Üí Affiche <code>db.engine.url</code> = <code>app.db</code> ‚ùå</li>
</ol>
<h3 id="flux-correct-apres-redemarrage">Flux correct (APR√àS red√©marrage)</h3>
<ol>
<li><strong>Wizard termine</strong> ‚Üí <code>.env</code> contient <code>qwerty.db</code></li>
<li><strong>Serveur red√©marre</strong> ‚Üí <code>config.py</code> recharge <code>.env</code></li>
<li><strong><code>config.py</code> lit</strong> : <code>SQLALCHEMY_DATABASE_URI=sqlite:///.../qwerty.db</code></li>
<li><strong>Serveur utilise</strong> : <code>qwerty.db</code> ‚úÖ</li>
<li><strong>Page verify-db</strong> ‚Üí Affiche <code>qwerty.db</code> ‚úÖ</li>
</ol>
<hr />
<h2 id="corrections-appliquees">‚úÖ Corrections appliqu√©es</h2>
<h3 id="1-changement-du-defaut-dans-configpy">1. Changement du d√©faut dans <code>config.py</code></h3>
<p><strong>Fichier</strong> : <code>backend/src/config.py</code> (ligne 93)</p>
<p><strong>Avant</strong> :</p>
<div class="highlight"><pre><span></span><code><span class="n">db_path</span> <span class="o">=</span> <span class="n">instance_dir</span> <span class="o">/</span> <span class="s2">&quot;app.db&quot;</span>  <span class="c1"># ‚ùå D√©faut diff√©rent du wizard</span>
</code></pre></div>

<p><strong>Apr√®s</strong> :</p>
<div class="highlight"><pre><span></span><code><span class="n">db_path</span> <span class="o">=</span> <span class="n">instance_dir</span> <span class="o">/</span> <span class="s2">&quot;x-filamenta_python.db&quot;</span>  <span class="c1"># ‚úÖ M√™me d√©faut que le wizard</span>
</code></pre></div>

<p><strong>Raison</strong> :<br />
Si <code>.env</code> n'est pas encore √©crit (premi√®re installation), au moins le d√©faut correspond au nom par d√©faut du wizard.</p>
<hr />
<h3 id="2-message-de-redemarrage-dans-donehtml">2. Message de red√©marrage dans done.html</h3>
<p><strong>Fichier</strong> : <code>frontend/templates/pages/install/partials/done.html</code></p>
<p><strong>Ajout√©</strong> :</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;alert alert-warning mx-auto mb-3&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;alert&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">h5</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;alert-heading&quot;</span><span class="p">&gt;</span>‚ö†Ô∏è Action requise : Red√©marrez le serveur<span class="p">&lt;/</span><span class="nt">h5</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;mb-2&quot;</span><span class="p">&gt;</span>
    Pour que les changements de configuration prennent effet (notamment le nom de la base de donn√©es), 
    vous devez <span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>red√©marrer le serveur<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span>.
  <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;mb-0&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Commande :<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span> 
    <span class="p">&lt;</span><span class="nt">code</span><span class="p">&gt;</span>Ctrl+C<span class="p">&lt;/</span><span class="nt">code</span><span class="p">&gt;</span> puis relancez le serveur
  <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>

<p><strong>Raison</strong> :<br />
Avertir clairement l'utilisateur qu'un red√©marrage est n√©cessaire.</p>
<hr />
<h2 id="test-final-procedure-complete">üß™ TEST FINAL - Proc√©dure compl√®te</h2>
<h3 id="etape-1-environnement-propre">√âtape 1 : Environnement propre</h3>
<div class="highlight"><pre><span></span><code><span class="c"># Supprimer toutes les BD</span>
<span class="nb">Remove-Item</span> <span class="n">instance</span><span class="p">\*.</span><span class="n">db</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>

<span class="c"># Supprimer le flag</span>
<span class="nb">Remove-Item</span> <span class="n">instance</span><span class="p">\</span><span class="n">installed</span><span class="p">.</span><span class="n">flag</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>

<span class="c"># Nettoyer .env</span>
<span class="nv">$env</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="p">.</span><span class="n">env</span>
<span class="nv">$cleaned</span> <span class="p">=</span> <span class="nv">$env</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span> <span class="o">-notmatch</span> <span class="s1">&#39;^\s*SQLALCHEMY_DATABASE_URI\s*=&#39;</span> <span class="p">}</span>
<span class="nb">Set-Content</span> <span class="p">.</span><span class="n">env</span> <span class="n">-Value</span> <span class="nv">$cleaned</span>
</code></pre></div>

<h3 id="etape-2-demarrer-le-serveur">√âtape 2 : D√©marrer le serveur</h3>
<div class="highlight"><pre><span></span><code><span class="p">.\.</span><span class="n">venv</span><span class="p">\</span><span class="n">Scripts</span><span class="p">\</span><span class="n">python</span><span class="p">.</span><span class="n">exe</span> <span class="n">run_prod</span><span class="p">.</span><span class="n">py</span>
</code></pre></div>

<h3 id="etape-3-lancer-le-wizard">√âtape 3 : Lancer le wizard</h3>
<p><strong>URL</strong> : http://127.0.0.1:5000/install/</p>
<h3 id="etape-4-specifier-un-nom-personnalise">√âtape 4 : Sp√©cifier un nom personnalis√©</h3>
<p>Dans "Base de donn√©es", champ SQLite :</p>
<div class="highlight"><pre><span></span><code>test-final.db
</code></pre></div>

<h3 id="etape-5-finaliser-le-wizard">√âtape 5 : Finaliser le wizard</h3>
<p>Compl√©tez toutes les √©tapes jusqu'√† "Installation termin√©e"</p>
<p><strong>‚ö†Ô∏è LISEZ L'AVERTISSEMENT ORANGE</strong> qui vous rappelle de red√©marrer !</p>
<h3 id="etape-6-redemarrer-le-serveur-obligatoire">√âtape 6 : RED√âMARRER LE SERVEUR (OBLIGATOIRE)</h3>
<div class="highlight"><pre><span></span><code><span class="c"># Arr√™ter le serveur</span>
<span class="nb">Get-Process</span> <span class="n">-Name</span> <span class="n">python</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Path</span> <span class="o">-like</span> <span class="s2">&quot;*\.venv\*&quot;</span><span class="p">}</span> <span class="p">|</span> <span class="nb">Stop-Process</span> <span class="n">-Force</span>

<span class="c"># Red√©marrer</span>
<span class="p">.\.</span><span class="n">venv</span><span class="p">\</span><span class="n">Scripts</span><span class="p">\</span><span class="n">python</span><span class="p">.</span><span class="n">exe</span> <span class="n">run_prod</span><span class="p">.</span><span class="n">py</span>
</code></pre></div>

<h3 id="etape-7-verifications">√âtape 7 : V√©rifications</h3>
<h4 id="verification-1-fichier-bd">‚úÖ V√©rification 1 : Fichier BD</h4>
<div class="highlight"><pre><span></span><code><span class="nb">Get-ChildItem</span> <span class="n">instance</span><span class="p">\*.</span><span class="n">db</span>
</code></pre></div>

<p><strong>R√©sultat attendu</strong> :</p>
<div class="highlight"><pre><span></span><code>Name            Length LastWriteTime
----            ------ -------------
test-final.db   [taille] [date/heure]
</code></pre></div>

<p>‚úÖ <strong>UNE SEULE BD</strong> avec le nom que vous avez choisi</p>
<h4 id="verification-2-env">‚úÖ V√©rification 2 : .env</h4>
<div class="highlight"><pre><span></span><code><span class="nb">Get-Content</span> <span class="p">.</span><span class="n">env</span> <span class="p">|</span> <span class="nb">Select-String</span> <span class="s2">&quot;SQLALCHEMY_DATABASE_URI&quot;</span>
</code></pre></div>

<p><strong>R√©sultat attendu</strong> :</p>
<div class="highlight"><pre><span></span><code>SQLALCHEMY_DATABASE_URI=sqlite:///D:/xarema/X-Filamenta-Python/instance/test-final.db
</code></pre></div>

<p>‚úÖ <strong>UNE SEULE LIGNE</strong> avec le bon nom</p>
<h4 id="verification-3-page-verify-db">‚úÖ V√©rification 3 : Page verify-db</h4>
<p><strong>Ouvrez</strong> : http://127.0.0.1:5000/install/verify-db</p>
<p><strong>V√©rifiez</strong> :</p>
<div class="highlight"><pre><span></span><code>‚úì Connexion r√©ussie
sqlite:///D:/xarema/X-Filamenta-Python/instance/test-final.db
</code></pre></div>

<p>‚úÖ <strong>Affiche le BON nom de BD</strong></p>
<h4 id="verification-4-login">‚úÖ V√©rification 4 : Login</h4>
<ol>
<li>Allez sur <code>/auth/login</code></li>
<li>Connectez-vous avec le compte admin cr√©√©</li>
<li>‚úÖ <strong>Le login fonctionne</strong> = La bonne BD est utilis√©e !</li>
</ol>
<hr />
<h2 id="resume-des-corrections">üìä R√©sum√© des corrections</h2>
<table>
<thead>
<tr>
<th>Probl√®me</th>
<th>Cause</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr>
<td>Affiche <code>app.db</code> au lieu de <code>qwerty.db</code></td>
<td>Serveur pas red√©marr√©</td>
<td><strong>Red√©marrer le serveur</strong></td>
</tr>
<tr>
<td>D√©faut diff√©rent entre wizard et config</td>
<td><code>app.db</code> vs <code>x-filamenta_python.db</code></td>
<td>Uniformis√© √† <code>x-filamenta_python.db</code></td>
</tr>
<tr>
<td>Utilisateur ne sait pas qu'il faut red√©marrer</td>
<td>Pas d'avertissement</td>
<td>Message orange ajout√© dans done.html</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="validation-regle-15">‚úÖ Validation (R√®gle 1.5)</h2>
<ul>
<li>[x] <code>config.py</code> relu au complet</li>
<li>[x] <code>done.html</code> relu au complet  </li>
<li>[x] Syntaxe valid√©e</li>
<li>[x] Logique test√©e</li>
<li>[x] Pas de r√©gression</li>
</ul>
<hr />
<h2 id="resultat-final-attendu">üéØ R√©sultat final attendu</h2>
<p><strong>Apr√®s red√©marrage du serveur</strong> :</p>
<p>‚úÖ Le nom de BD que vous sp√©cifiez dans le wizard est <strong>utilis√©</strong><br />
‚úÖ <code>.env</code> contient le <strong>bon chemin</strong><br />
‚úÖ La page verify-db affiche le <strong>bon nom</strong><br />
‚úÖ Le login <strong>fonctionne</strong><br />
‚úÖ <strong>UNE SEULE BD</strong> avec le nom correct<br />
‚úÖ <strong>UNE SEULE ligne</strong> dans <code>.env</code>  </p>
<hr />
<h2 id="important-a-retenir">‚ö†Ô∏è IMPORTANT - √Ä RETENIR</h2>
<p><strong>APR√àS CHAQUE INSTALLATION VIA LE WIZARD</strong> :</p>
<ol>
<li>‚úÖ Finalisez le wizard</li>
<li>‚úÖ <strong>RED√âMARREZ LE SERVEUR</strong> (Ctrl+C + relancer)</li>
<li>‚úÖ Testez le login</li>
</ol>
<p><strong>Sans red√©marrage</strong> ‚Üí L'ancienne configuration en m√©moire est utilis√©e<br />
<strong>Avec red√©marrage</strong> ‚Üí Nouvelle configuration charg√©e depuis <code>.env</code></p>
<hr />
<p><strong>Le probl√®me √©tait simple : vous n'aviez pas red√©marr√© le serveur !</strong><br />
<strong>Maintenant, avec l'avertissement, vous le saurez.</strong> üéâ</p>

            <footer style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid #e0e0e0;">
                <p style="color: #666; font-size: 0.9rem;">
                    ¬© 2025 XAREMA. Licensed under <strong>AGPL-3.0-or-later</strong>.
                    <a href="https://github.com/XAREMA" target="_blank">View source</a>
                </p>
            </footer>
        </main>
    </div>
</body>
</html>
