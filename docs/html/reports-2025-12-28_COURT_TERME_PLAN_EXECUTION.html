<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="X-Filamenta Documentation - Court Terme â€” Audit + Plan d'ExÃ©cution (Jours 2â€“3)">
    <title>Court Terme â€” Audit + Plan d'ExÃ©cution (Jours 2â€“3) - X-Filamenta Documentation</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>ğŸ“š X-Filamenta Documentation</h1>
        <nav>
            <a href="index.html">Home</a>
            <a href="all-pages.html">All Pages</a>
            <a href="analysis-reports.html">Analysis Reports</a>
        </nav>
    </header>

    <div class="container">
        <aside class="sidebar">
            <div class="sidebar-section">
  <div class="sidebar-title">Getting Started</div>
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="00_START_HERE.html">Start Here</a></li>
    <li><a href="guides-QUICKSTART.html">Quick Start</a></li>
    <li><a href="REFERENCE.html">Reference</a></li>
  </ul>
</div>
<div class="sidebar-section">
  <div class="sidebar-title">Features</div>
  <ul>
    <li><a href="features-README.html">Overview</a></li>
    <li><a href="features-authentication.html">Authentication</a></li>
    <li><a href="features-wizard-installation.html">Installation Wizard</a></li>
    <li><a href="features-internationalization.html">Internationalization</a></li>
    <li><a href="features-database.html">Database Support</a></li>
  </ul>
</div>
<div class="sidebar-section">
  <div class="sidebar-title">Deployment</div>
  <ul>
    <li><a href="deployment-DEPLOYMENT.html">Overview</a></li>
    <li><a href="deployment-DEPLOYMENT_CPANEL.html">cPanel</a></li>
    <li><a href="deployment-DEPLOYMENT_VPS.html">VPS/Linux</a></li>
    <li><a href="deployment-DEPLOYMENT_DOCKER.html">Docker</a></li>
  </ul>
</div>
<div class="sidebar-section">
  <div class="sidebar-title">Architecture</div>
  <ul>
    <li><a href="architecture-README.html">Overview</a></li>
    <li><a href="DATABASE.html">Database</a></li>
    <li><a href="technical-WSGI_AND_MULTIDB_ADAPTATION.html">WSGI & Multi-DB</a></li>
  </ul>
</div>
<div class="sidebar-section">
  <div class="sidebar-title">Security</div>
  <ul>
    <li><a href="security-README.html">Overview</a></li>
  </ul>
</div>
<div class="sidebar-section">
  <div class="sidebar-title">Contributing</div>
  <ul>
    <li><a href="contributing-README.html">Guidelines</a></li>
  </ul>
</div>
<div class="sidebar-section">
  <div class="sidebar-title">Help</div>
  <ul>
    <li><a href="troubleshooting-README.html">Troubleshooting</a></li>
    <li><a href="troubleshooting-faq.html">FAQ</a></li>
    <li><a href="troubleshooting-common-issues.html">Common Issues</a></li>
    <li><a href="analysis-reports.html">Analysis Reports</a></li>
  </ul>
</div>

        </aside>

        <main class="main">
            <h1 id="court-terme-audit-plan-dexecution-jours-23">Court Terme â€” Audit + Plan d'ExÃ©cution (Jours 2â€“3)</h1>
<p><strong>Date :</strong> 2025-12-28 18:00 UTC+1<br />
<strong>Scope :</strong> AmÃ©lioration sÃ©curitÃ© (headers), qualitÃ© code (docstrings, type hints), tests<br />
<strong>Status :</strong> ğŸ“‹ Planification + ExÃ©cution</p>
<hr />
<h2 id="objectifs-court-terme">ğŸ¯ OBJECTIFS COURT TERME</h2>
<h3 id="ct-1-security-headers-csp-x-frame-options">CT-1 : Security Headers (CSP, X-Frame-Options)</h3>
<ul>
<li>Ajouter Content-Security-Policy</li>
<li>Ajouter X-Frame-Options: DENY</li>
<li>Ajouter X-Content-Type-Options: nosniff</li>
<li>Ajouter Strict-Transport-Security (prod)</li>
<li>Impact sÃ©curitÃ© : <strong>HIGH</strong> â­â­â­</li>
</ul>
<h3 id="ct-2-tests-linting-validation">CT-2 : Tests + Linting Validation</h3>
<ul>
<li>ExÃ©cuter tests complets (<code>pytest -q</code>)</li>
<li>VÃ©rifier linting (<code>ruff check .</code>)</li>
<li>VÃ©rifier type checking (<code>mypy backend/src</code>)</li>
<li>AmÃ©liorer tests existants (couverture +5%)</li>
<li>Impact qualitÃ© : <strong>MEDIUM</strong> â­â­</li>
</ul>
<h3 id="ct-3-docstrings-type-hints">CT-3 : Docstrings + Type Hints</h3>
<ul>
<li>Ajouter docstrings (20+ fonctions publiques)</li>
<li>ComplÃ©ter type hints (signatures)</li>
<li>Impact maintenabilitÃ© : <strong>HIGH</strong> â­â­â­</li>
</ul>
<hr />
<h2 id="analyse-pre-execution">ğŸ“Š ANALYSE PRÃ‰-EXÃ‰CUTION</h2>
<h3 id="fichiers-a-modifier">Fichiers Ã  Modifier</h3>
<h4 id="ct-1-security-headers">CT-1 : Security Headers</h4>
<ul>
<li><code>backend/src/app.py</code> â€” Flask app factory (ajouter middleware/headers)</li>
<li>Alternative : CrÃ©er <code>backend/src/middleware.py</code> (clean separation)</li>
</ul>
<h4 id="ct-2-tests">CT-2 : Tests</h4>
<ul>
<li><code>backend/tests/**/*.py</code> â€” ExÃ©cuter sans modifications</li>
<li>VÃ©rifier avec ruff + mypy</li>
</ul>
<h4 id="ct-3-docstrings-type-hints_1">CT-3 : Docstrings + Type Hints</h4>
<ul>
<li><code>backend/src/services/*.py</code> â€” 8 services (docstrings manquantes)</li>
<li><code>backend/src/routes/*.py</code> â€” 10 routes (docstrings inÃ©gales)</li>
<li><code>backend/src/models/*.py</code> â€” 4 models (type hints partiels)</li>
</ul>
<hr />
<h2 id="ct-1-security-headers-plan-detaille">ğŸ” CT-1 : SECURITY HEADERS â€” PLAN DÃ‰TAILLÃ‰</h2>
<h3 id="approche-1-recommandee-middleware-separe">Approche 1 (RecommandÃ©e) : Middleware SÃ©parÃ©</h3>
<p><strong>Avantage :</strong> SÃ©paration des concerns, rÃ©utilisable, testable</p>
<div class="highlight"><pre><span></span><code><span class="c1"># backend/src/middleware.py</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_security_headers</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Security-Policy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;default-src &#39;self&#39;; script-src &#39;self&#39; &#39;unsafe-inline&#39; cdn.jsdelivr.net; style-src &#39;self&#39; &#39;unsafe-inline&#39; cdn.jsdelivr.net; img-src &#39;self&#39; data: https:; font-src &#39;self&#39; cdn.jsdelivr.net; connect-src &#39;self&#39; https://cdn.jsdelivr.net&quot;</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-Frame-Options&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;DENY&#39;</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-Content-Type-Options&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;nosniff&#39;</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-XSS-Protection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1; mode=block&#39;</span>
    <span class="k">if</span> <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ENV&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;production&#39;</span><span class="p">:</span>
        <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Strict-Transport-Security&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;max-age=31536000; includeSubDomains&#39;</span>
    <span class="k">return</span> <span class="n">response</span>
</code></pre></div>

<p><strong>IntÃ©gration dans <code>app.py</code> :</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">app</span><span class="o">.</span><span class="n">after_request</span><span class="p">(</span><span class="n">add_security_headers</span><span class="p">)</span>
</code></pre></div>

<h3 id="headers-a-ajouter">Headers Ã  Ajouter</h3>
<table>
<thead>
<tr>
<th>Header</th>
<th>Valeur</th>
<th>Raison</th>
</tr>
</thead>
<tbody>
<tr>
<td>CSP</td>
<td>default-src 'self' + whitelist</td>
<td>XSS protection</td>
</tr>
<tr>
<td>X-Frame-Options</td>
<td>DENY</td>
<td>Clickjacking protection</td>
</tr>
<tr>
<td>X-Content-Type-Options</td>
<td>nosniff</td>
<td>MIME sniffing prevention</td>
</tr>
<tr>
<td>X-XSS-Protection</td>
<td>1; mode=block</td>
<td>XSS legacy browser support</td>
</tr>
<tr>
<td>HSTS</td>
<td>max-age=31536000 (prod only)</td>
<td>Force HTTPS</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="ct-2-tests-linting-plan-detaille">ğŸ§ª CT-2 : TESTS + LINTING â€” PLAN DÃ‰TAILLÃ‰</h2>
<h3 id="commandes-a-executer">Commandes Ã  ExÃ©cuter</h3>
<div class="highlight"><pre><span></span><code><span class="c"># Tests</span>
<span class="n">pytest</span> <span class="n">-q</span> <span class="p">-</span><span class="n">-disable-warnings</span> <span class="p">-</span><span class="n">-maxfail</span><span class="p">=</span><span class="n">1</span> <span class="p">-</span><span class="n">-cov</span><span class="p">=</span><span class="n">backend</span><span class="p">/</span><span class="n">src</span> <span class="p">-</span><span class="n">-cov-report</span><span class="p">=</span><span class="n">term-missing</span>

<span class="c"># Linting</span>
<span class="n">ruff</span> <span class="n">check</span> <span class="p">.</span> <span class="p">-</span><span class="n">-select</span><span class="p">=</span><span class="n">E</span><span class="p">,</span><span class="n">W</span><span class="p">,</span><span class="n">F</span>
<span class="n">ruff</span> <span class="n">format</span> <span class="p">-</span><span class="n">-check</span> <span class="p">.</span>

<span class="c"># Type checking</span>
<span class="n">mypy</span> <span class="n">backend</span><span class="p">/</span><span class="n">src</span>

<span class="c"># Frontend</span>
<span class="n">npm</span> <span class="n">run</span> <span class="n">lint</span>
<span class="n">npm</span> <span class="n">run</span> <span class="n">fmt</span> <span class="p">--</span> <span class="p">-</span><span class="n">-check</span>
</code></pre></div>

<h3 id="amelioration-tests-existants-c3">AmÃ©lioration Tests Existants (C3)</h3>
<p><strong>StratÃ©gie :</strong> AmÃ©liorer couverture tests existants (+5%) sans ajouter de nouvelles suites</p>
<p>Fichiers test Ã  amÃ©liorer :<br />
- <code>test_auth.py</code> â€” Ajouter edge cases<br />
- <code>test_csrf.py</code> â€” AmÃ©liorer couverture<br />
- <code>test_admin.py</code> â€” ComplÃ©ter scenarios<br />
- <code>test_install_wizard.py</code> â€” VÃ©rifier coverage</p>
<hr />
<h2 id="ct-3-docstrings-type-hints-plan-detaille">ğŸ“ CT-3 : DOCSTRINGS + TYPE HINTS â€” PLAN DÃ‰TAILLÃ‰</h2>
<h3 id="fichiers-services-a-documenter-8">Fichiers Services Ã  Documenter (8)</h3>
<div class="highlight"><pre><span></span><code>âœ… user_service.py       â€” 15+ functions (partielles)
âœ… csrf_service.py       â€” 5 functions (incomplÃ¨tes)
âœ… totp_service.py       â€” 10 functions (partielles)
âœ… i18n_service.py       â€” 3 functions
âœ… content_service.py    â€” 10 functions
âœ… preferences_service.py â€” 5 functions
âœ… install_service.py    â€” 15+ functions
âœ… rate_limiter.py       â€” 4 functions
</code></pre></div>

<h3 id="format-docstring-standard">Format Docstring Standard</h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">example_function</span><span class="p">(</span><span class="n">param1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">param2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Brief description (one line).</span>

<span class="sd">    Longer description if needed (optional).</span>

<span class="sd">    Args:</span>
<span class="sd">        param1: Description of param1</span>
<span class="sd">        param2: Description of param2 (default 0)</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict with keys &#39;status&#39;, &#39;data&#39;, &#39;error&#39;</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If param1 is empty</span>
<span class="sd">        InvalidUserError: If user not found</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; result = example_function(&quot;test&quot;, 42)</span>
<span class="sd">        &gt;&gt;&gt; assert result[&#39;status&#39;] == &#39;success&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Implementation</span>
</code></pre></div>

<h3 id="type-hints-a-completer">Type Hints Ã  ComplÃ©ter</h3>
<p>Fichiers models (type hints partiels) :<br />
- <code>models/user.py</code> â€” Attributs SQLAlchemy + methods<br />
- <code>models/content.py</code> â€” Attributs + relationships<br />
- <code>models/preferences.py</code> â€” Attributs + defaults<br />
- <code>models/admin_history.py</code> â€” Attributs JSON</p>
<hr />
<h2 id="timeline-execution">â±ï¸ TIMELINE EXÃ‰CUTION</h2>
<table>
<thead>
<tr>
<th>Phase</th>
<th>Fichiers</th>
<th>Effort</th>
<th>DurÃ©e</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>CT-1 : Security Headers</strong></td>
<td>2 (app.py + middleware.py)</td>
<td>S</td>
<td>1h</td>
</tr>
<tr>
<td><strong>CT-2 : Tests + Linting</strong></td>
<td>All (exÃ©cution)</td>
<td>M</td>
<td>1.5h</td>
</tr>
<tr>
<td><strong>CT-3 : Docstrings + Types</strong></td>
<td>12+ files</td>
<td>M</td>
<td>2â€“3h</td>
</tr>
<tr>
<td><strong>TOTAL</strong></td>
<td>â€”</td>
<td>M</td>
<td><strong>4.5â€“5h</strong></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="verifications-post-execution">âœ… VÃ‰RIFICATIONS POST-EXÃ‰CUTION</h2>
<div class="highlight"><pre><span></span><code><span class="c"># 1. Security headers prÃ©sents</span>
<span class="n">grep</span> <span class="n">-r</span> <span class="s2">&quot;Content-Security-Policy&quot;</span> <span class="n">backend</span><span class="p">/</span><span class="n">src</span> <span class="p">-</span><span class="n">-include</span><span class="p">=</span><span class="s2">&quot;*.py&quot;</span>

<span class="c"># 2. Tests passent</span>
<span class="n">pytest</span> <span class="n">-q</span> <span class="p">-</span><span class="n">-disable-warnings</span>

<span class="c"># 3. Linting OK</span>
<span class="n">ruff</span> <span class="n">check</span> <span class="p">.</span> <span class="p">-</span><span class="n">-select</span><span class="p">=</span><span class="n">E</span><span class="p">,</span><span class="n">W</span><span class="p">,</span><span class="n">F</span>

<span class="c"># 4. Types OK</span>
<span class="n">mypy</span> <span class="n">backend</span><span class="p">/</span><span class="n">src</span>

<span class="c"># 5. Docstrings ajoutÃ©es</span>
<span class="n">grep</span> <span class="n">-r</span> <span class="s1">&#39;&quot;&quot;&quot;&#39;</span> <span class="n">backend</span><span class="p">/</span><span class="n">src</span> <span class="p">-</span><span class="n">-include</span><span class="p">=</span><span class="s2">&quot;*.py&quot;</span> <span class="p">|</span> <span class="n">wc</span> <span class="n">-l</span>
</code></pre></div>

<hr />
<h2 id="metriques-avantapres">ğŸ“Š MÃ‰TRIQUES AVANT/APRÃˆS</h2>
<h3 id="securite">SÃ©curitÃ©</h3>
<table>
<thead>
<tr>
<th>MÃ©trique</th>
<th>Avant</th>
<th>AprÃ¨s</th>
</tr>
</thead>
<tbody>
<tr>
<td>Security Headers</td>
<td>ğŸŸ¡ Absents</td>
<td>âœ… PrÃ©sents</td>
</tr>
<tr>
<td>CSP Policy</td>
<td>âŒ Non</td>
<td>âœ… Oui</td>
</tr>
<tr>
<td>X-Frame-Options</td>
<td>âŒ Non</td>
<td>âœ… DENY</td>
</tr>
<tr>
<td>HSTS (prod)</td>
<td>âŒ Non</td>
<td>âœ… Oui</td>
</tr>
</tbody>
</table>
<h3 id="qualite-code">QualitÃ© Code</h3>
<table>
<thead>
<tr>
<th>MÃ©trique</th>
<th>Avant</th>
<th>AprÃ¨s</th>
</tr>
</thead>
<tbody>
<tr>
<td>Docstrings</td>
<td>ğŸŸ¡ 60%</td>
<td>âœ… 90%+</td>
</tr>
<tr>
<td>Type Hints</td>
<td>ğŸŸ¡ 70%</td>
<td>âœ… 90%+</td>
</tr>
<tr>
<td>Tests Coverage</td>
<td>ğŸŸ¡ 40â€“50%</td>
<td>âœ… 45â€“55%</td>
</tr>
<tr>
<td>Linting</td>
<td>ğŸŸ¡ Ã€ auditer</td>
<td>âœ… Clean</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="status">ğŸš€ STATUS</h2>
<p><strong>Ã‰tat :</strong> ğŸ“‹ Plan prÃªt â†’ ExÃ©cution commence maintenant<br />
<strong>Prochaine Ã©tape :</strong> CT-1 â€” Ajouter Security Headers</p>
<hr />
<p><em>Rapport gÃ©nÃ©rÃ© : 2025-12-28 18:00 UTC+1</em></p>

            <footer style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid #e0e0e0;">
                <p style="color: #666; font-size: 0.9rem;">
                    Â© 2025 XAREMA. Licensed under <strong>AGPL-3.0-or-later</strong>.
                    <a href="https://github.com/XAREMA" target="_blank">View source</a>
                </p>
            </footer>
        </main>
    </div>
</body>
</html>
