<!--
Purpose: Admin edit user form
Description: Edit existing user with optional password change

File: frontend/templates/admin/users_edit.html
Created: 2025-12-30T01:05:00+01:00

License: AGPL-3.0-or-later
Copyright (c) 2025 XAREMA. All rights reserved.
-->

{% extends 'layouts/admin.html' %}

{% block title %}{{ t('admin.users.edit.title') }} - {{ user.username }}{% endblock %}

{% block content %}
<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <!-- Header -->
      <div class="d-flex align-items-center mb-4">
        <a href="{{ url_for('admin_users.list_users') }}" class="btn btn-outline-secondary me-3">
          <i class="bi bi-arrow-left"></i>
        </a>
        <h1 class="h3 mb-0">{{ t('admin.users.edit.title') }} - {{ user.username }}</h1>
      </div>

      <!-- User Info Card -->
      <div class="card mb-3">
        <div class="card-body">
          <div class="row">
            <div class="col-md-6">
              <p class="mb-1">
                <strong>{{ t('admin.users.edit.user_id') }}:</strong> {{ user.id }}
              </p>
              <p class="mb-1">
                <strong>{{ t('admin.users.edit.created_at') }}:</strong>
                {{ user.created_at.strftime('%Y-%m-%d %H:%M') }}
              </p>
            </div>
            <div class="col-md-6">
              <p class="mb-1">
                <strong>{{ t('admin.users.edit.last_login') }}:</strong>
                {{ user.last_login.strftime('%Y-%m-%d %H:%M') if user.last_login else t('admin.users.edit.never') }}
              </p>
              <p class="mb-1">
                <strong>{{ t('admin.users.edit.email_verified') }}:</strong>
                {% if user.email_verified %}
                <i class="bi bi-check-circle-fill text-success"></i> {{ t('admin.users.edit.yes') }}
                {% else %}
                <i class="bi bi-x-circle-fill text-danger"></i> {{ t('admin.users.edit.no') }}
                {% endif %}
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Edit Form -->
      <div class="card">
        <div class="card-body">
          <form method="POST">
            <!-- Username (readonly) -->
            <div class="mb-3">
              <label for="username" class="form-label">
                {{ t('admin.users.edit.username') }}
              </label>
              <input type="text"
                     class="form-control"
                     id="username"
                     value="{{ user.username }}"
                     disabled>
              <small class="form-text text-muted">
                {{ t('admin.users.edit.username_readonly') }}
              </small>
            </div>

            <!-- Email -->
            <div class="mb-3">
              <label for="email" class="form-label">
                {{ t('admin.users.edit.email') }}
                <span class="text-danger">*</span>
              </label>
              <input type="email"
                     class="form-control"
                     id="email"
                     name="email"
                     value="{{ user.email }}"
                     required>
            </div>

            <!-- Password (optional) -->
            <div class="mb-3">
              <label for="password" class="form-label">
                {{ t('admin.users.edit.password') }}
              </label>
              <input type="password"
                     class="form-control"
                     id="password"
                     name="password"
                     minlength="8">
              <small class="form-text text-muted">
                {{ t('admin.users.edit.password_hint') }}
              </small>
            </div>

            <!-- Role -->
            <div class="mb-3">
              <div class="form-check form-switch">
                <input class="form-check-input"
                       type="checkbox"
                       id="is_admin"
                       name="is_admin"
                       {% if user.is_admin %}checked{% endif %}>
                <label class="form-check-label" for="is_admin">
                  {{ t('admin.users.edit.is_admin') }}
                </label>
              </div>
            </div>

            <!-- Active -->
            <div class="mb-4">
              <div class="form-check form-switch">
                <input class="form-check-input"
                       type="checkbox"
                       id="is_active"
                       name="is_active"
                       {% if user.is_active %}checked{% endif %}>
                <label class="form-check-label" for="is_active">
                  {{ t('admin.users.edit.is_active') }}
                </label>
              </div>
            </div>

            <!-- Actions -->
            <div class="d-flex gap-2">
              <button type="submit" class="btn btn-primary">
                <i class="bi bi-check-circle me-1"></i>
                {{ t('admin.users.edit.submit') }}
              </button>
              <a href="{{ url_for('admin_users.list_users') }}" class="btn btn-secondary">
                {{ t('admin.users.edit.cancel') }}
              </a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

