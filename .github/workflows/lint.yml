name: ğŸ§¹ Lint

on:
  push:
    branches: [ main, develop, copilot/** ]
  pull_request:
    branches: [ main, develop ]
  workflow_dispatch:

jobs:
  lint-python:
    name: ğŸ Python Linting
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v4

      - name: ğŸ Set up Python 3.12
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'
          cache: 'pip'

      - name: ğŸ“¦ Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install ruff mypy
          pip install -e .

      - name: ğŸ” Run Ruff linter
        run: ruff check .

      - name: ğŸ¨ Check Ruff formatting
        run: ruff format --check .

      - name: ğŸ” Run mypy type checker
        run: mypy backend/src
        continue-on-error: true

  lint-javascript:
    name: ğŸ“œ JavaScript/CSS Linting
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v4

      - name: ğŸ“¦ Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      - name: ğŸ“¦ Install dependencies
        run: npm ci

      - name: ğŸ” Run ESLint
        run: npm run lint:js

      - name: ğŸ¨ Run Stylelint
        run: npm run lint:css

      - name: ğŸ” Check Prettier formatting
        run: npm run fmt:check

  lint-markdown:
    name: ğŸ“ Markdown Linting
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v4

      - name: ğŸ” Lint markdown files
        uses: DavidAnson/markdownlint-cli2-action@v19
        with:
          globs: |
            **/*.md
            !node_modules
            !.venv
            !docs/archive
