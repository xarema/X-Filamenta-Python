<!--
------------------------------------------------------------------------------
Purpose: Wizard upload form
Description: Upload backup tar.gz/tgz with checksum optional

File: frontend/templates/pages/install/partials/upload_form.html | Repository: X-Filamenta-Python
Created: 2025-12-27T00:00:00+00:00
Last modified (Git): 2025-12-28T13:54:00+01:00 | Commit: TBD

Distributed by: XAREMA | Coder: AleGabMar
App version: 0.0.1-Alpha | File version: 0.0.2-Alpha

License: AGPL-3.0-or-later
SPDX-License-Identifier: AGPL-3.0-or-later

Copyright (c) 2025 XAREMA. All rights reserved.

Metadata:

- Status: Stable
- Classification: Public
------------------------------------------------------------------------------
-->

<div class="card shadow-sm mb-3">
  <div class="card-body text-center">
    <h5 class="card-title mb-3">{{ t('wizard.backup.title') or 'Restauration de sauvegarde' }}</h5>
    <p class="text-muted">{{ t('wizard.backup.description') or 'Vous pouvez restaurer une sauvegarde ou continuer sans backup.' }}</p>

    <form
      method="POST" action="/install/step"


      enctype="multipart/form-data"
      class="mx-auto"
      style="max-width: 500px;"
    >
      <input type="hidden" name="step" value="upload" />
      <!-- PrÃ©server db_uri -->
      {% if state.db_uri %}
      <input type="hidden" name="db_uri" value="{{ state.db_uri }}" />
      {% endif %}

      <div class="mb-4">
        <label for="backup-file" class="form-label">{{ t('wizard.backup.upload') }}</label>
        <div class="input-group">
          <input type="file" name="backup" id="backup-file" class="form-control" accept=".tar.gz,.tgz" />
        </div>
        <small class="text-muted d-block mt-1">{{ t('wizard.backup.formats') }}</small>
        <small class="text-muted d-block" id="file-label">{{ t('wizard.backup.no_file') }}</small>
      </div>

      <script>
        document.addEventListener('DOMContentLoaded', function() {
          const fileInput = document.getElementById('backup-file');
          const fileLabel = document.getElementById('file-label');
          const noFileText = "{{ t('wizard.backup.no_file') }}";

          if (fileInput) {
            fileInput.addEventListener('change', function() {
              fileLabel.textContent = this.files[0] ? this.files[0].name : noFileText;
            });
          }
        });
      </script>

      <div class="d-flex flex-wrap gap-3 justify-content-center">
        <div class="d-flex flex-wrap justify-content-center gap-3 mt-3">
          <button class="btn btn-primary btn-lg px-4" type="submit">
            {{ t('wizard.backup.upload_button') }}
          </button>
        </div>
      </form>

      <!-- Bouton passer sans backup -->
      <form method="POST" action="/install/step" class="mt-3">
        <input type="hidden" name="step" value="admin_form" />
        {% if state.db_uri %}
        <input type="hidden" name="db_uri" value="{{ state.db_uri }}" />
        {% endif %}
        <div class="d-flex flex-wrap justify-content-center gap-3">
          <button class="btn btn-outline-secondary btn-lg px-4" type="submit">
            {{ t('wizard.db.continue_no_backup') }}
          </button>
        </div>
      </form>
  </div>
</div>
